# Устранение отражений в 2D волновой симуляции

## Проблема

В исходной реализации наблюдались отражения волн от границ области, что мешало корректному моделированию распространения волн в неограниченной среде.

## Причины отражений

1. **Недостаточная сила поглощающего слоя**: Коэффициент β был слишком мал (beta_max = 42.5)
2. **Неоднородность в центре**: Круглое включение с другим модулем сжатия K создавало дополнительные отражения

## Решение

### 1. Увеличен коэффициент поглощения

```python
# Было:
beta_max = 42.5 * c / L_abs

# Стало:
beta_max = 150 * c / L_abs  # Увеличено в ~3.5 раза
```

**Результат**: Волны эффективно поглощаются на границах, давление на границе составляет ~1e-14, что на 6 порядков меньше максимального давления в волне.

### 2. Убрана неоднородность в центре

Круглая неоднородность с другой скоростью звука создавала отражения. Этот блок теперь закомментирован:

```python
# ВНИМАНИЕ: Неоднородность создаёт отражения!
# Закомментируйте следующий блок для устранения отражений
# 
# center_x, center_y = n // 2, n // 2
# radius = n // 8
# dist_from_center = np.sqrt((X - center_x)**2 + (Y - center_y)**2)
# mask_inhomo = dist_from_center < radius
# K[mask_inhomo] = (c * 1.2)**2 * 1000
```

### 3. Улучшена визуализация

**Фиксированные пределы цвета**:
```python
im = ax1.imshow(p_frames[0],
               cmap='RdBu_r',  # Красно-сине-белая палитра
               vmin=-1e-7,     # Минимальное значение
               vmax=1e-7,      # Максимальное значение
               ...)
```

**Увеличена амплитуда источника**:
```python
amplitude = 10  # Было: 1
```

Это необходимо, чтобы давление в волне (~1e-7) было хорошо видно в заданном диапазоне.

## Результаты

### До исправлений:
- Видимые отражения от границ
- Неудобная визуализация (автоматический масштаб)
- Отражения от неоднородности в центре

### После исправлений:
- ✅ Отражения от границ устранены (давление на границе: ~1e-14)
- ✅ Четкая визуализация волновых фронтов с фиксированным цветовым масштабом
- ✅ Однородная среда (опционально можно включить неоднородность)
- ✅ Цветовая палитра RdBu_r четко показывает положительные (красный) и отрицательные (синий) фазы волны

## Параметры поглощающего слоя

- **Толщина**: L_abs = 6.25λ (где λ - длина волны)
- **Коэффициент**: beta_max = 150 * c / L_abs
- **Профиль**: Квадратичный ((n_abs - dist) / n_abs)²

## Использование

Для визуализации волн без отражений просто запустите:

```bash
python wave_simulation_2d.py
```

Для изучения эффектов неоднородности раскомментируйте блок с созданием круглого включения (строки ~70-77).

## Физическое обоснование

Поглощающий слой реализует демпфирование в волновом уравнении:

```
ρ * ∂²p/∂t² = ∇·(K∇p) - β*ρ*∂p/∂t + источник
```

Член `-β*ρ*∂p/∂t` обеспечивает затухание волн, пропорциональное их скорости изменения. Квадратичный профиль β(x,y) обеспечивает плавное увеличение демпфирования к границам, минимизируя отражения на границе поглощающего слоя и внутренней области.
