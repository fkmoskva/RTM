# Реализация вертикального раздела сред

## Требования пользователя

1. ✅ График с фиксированными пределами **vmin=-1e-7, vmax=1e-7**
2. ✅ Раздел сред в слое где **beta = 0** (внутренний квадрат)
3. ✅ Вертикальный отрезок **посередине** внутреннего квадрата
4. ✅ Улучшенная визуализация

## Реализация

### 1. Фиксированная цветовая шкала

```python
im = ax1.imshow(p_frames[0],
               cmap='RdBu_r',
               vmin=-1e-7,     # Фиксированный минимум
               vmax=1e-7,      # Фиксированный максимум
               ...)
```

**Результат**: Стабильная визуализация волн без автомасштабирования.

### 2. Внутренний квадрат (область где beta = 0)

Внутренняя область определяется как:
```python
inner_region_mask = dist >= n_abs
```

где `n_abs = 85` узлов - толщина поглощающего слоя.

**Параметры внутреннего квадрата**:
- Размер: от узла 85 до узла 115 в каждом направлении (30 узлов × 30 узлов)
- В физических координатах: от ~85 м до ~115 м

### 3. Вертикальный раздел сред

**Положение**: x = n/2 = 100 узлов (100 метров)

**Левая половина** (x < 100):
- Скорость звука: c = 340 м/с
- Плотность: ρ = 1200 кг/м³
- Модуль сжатия: K = c² × ρ = 1.39×10⁸ Па

**Правая половина** (x ≥ 100):
- Скорость звука: c = 442 м/с (на 30% выше)
- Плотность: ρ = 1000 кг/м³ (на 17% ниже)
- Модуль сжатия: K = c² × ρ = 1.95×10⁸ Па

```python
# Вертикальный раздел
middle_x = n // 2
right_half_mask = inner_region_mask & (X >= middle_x)

# Разные параметры слева и справа
rho[right_half_mask] = 1000
K[right_half_mask] = c_right**2 * 1000
```

### 4. Улучшенная визуализация

**Левая панель - Волновое поле**:
- Цветовая карта: RdBu_r (красный-белый-синий)
- Фиксированные пределы: ±1e-7
- Желтая пунктирная линия показывает раздел сред
- Легенда с подписью

**Правая панель - Структура среды**:
- Показывает поле скорости звука c(x,y) = √(K/ρ)
- Черная сплошная линия показывает раздел
- Текстовые аннотации с параметрами каждой среды
- Улучшенная цветовая шкала

```python
# Вычисляем поле скорости звука
c_field = np.sqrt(K / rho)

# Визуализация с аннотациями
ax2.text(length/4, length*0.95, f'c={c_left} м/с\nρ=1200 кг/м³', ...)
ax2.text(3*length/4, length*0.95, f'c={c_right:.0f} м/с\nρ=1000 кг/м³', ...)
```

## Физические эффекты

При распространении волны через вертикальный раздел наблюдаются:

1. **Отражение**: Часть волны отражается обратно
2. **Преломление**: Проходящая волна меняет скорость
3. **Изменение длины волны**: λ = c/f изменяется при переходе

Коэффициенты отражения и прохождения зависят от:
- Акустического импеданса Z = ρ × c
- Слева: Z₁ = 1200 × 340 = 408,000 кг/(м²·с)
- Справа: Z₂ = 1000 × 442 = 442,000 кг/(м²·с)

## Результаты

См. изображения:
- `vertical_interface_test.png` - эволюция волнового поля во времени
- `vertical_interface_snapshot.png` - финальная визуализация

**Наблюдаемые явления**:
- Чистое распространение волн от источника в центре
- Отражение и преломление на вертикальном разделе
- Разная скорость распространения в левой и правой половинах
- Отсутствие отражений от внешних границ (благодаря поглощающему слою)

## Использование

```bash
# Запуск симуляции
python wave_simulation_2d.py
```

Программа создаст анимацию показывающую:
- Распространение волн через вертикальный раздел
- Взаимодействие волн с границей раздела
- Стабильную визуализацию с фиксированной цветовой шкалой
